<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste Debug - Progresso Espiritual Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background: #f5f5f5;
        }
        .debug-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
            margin: 20px 0;
        }
        .progress-card {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .btn:hover {
            background: #0056b3;
        }
        .log {
            background: #f8f9fa;
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
        }
        .success {
            background: #d4edda;
            color: #155724;
        }
    </style>
</head>
<body>
    <h1>üîç Debug - Progresso Espiritual Dashboard</h1>
    
    <div class="debug-section">
        <h2>üìã Status dos Scripts</h2>
        <button class="btn" onclick="checkScripts()">Verificar Scripts</button>
        <div id="scriptStatus"></div>
    </div>

    <div class="debug-section">
        <h2>üîÑ Inicializa√ß√£o Manual</h2>
        <button class="btn" onclick="initializeProgressSync()">Inicializar ProgressSync</button>
        <button class="btn" onclick="forceSync()">For√ßar Sincroniza√ß√£o</button>
        <div id="initializationStatus"></div>
    </div>

    <div class="debug-section">
        <h2>üß™ Dados de Teste</h2>
        <button class="btn" onclick="addTestData()">Adicionar Dados de Teste</button>
        <button class="btn" onclick="clearTestData()">Limpar Dados de Teste</button>
        <button class="btn" onclick="checkCurrentData()">Verificar Dados Atuais</button>
        <div id="testDataStatus"></div>
    </div>

    <div class="debug-section">
        <h2>üìä Dados do localStorage</h2>
        <button class="btn" onclick="checkLocalStorage()">Verificar localStorage</button>
        <div id="localStorageStatus"></div>
    </div>

    <div class="debug-section">
        <h2>üéØ Elemento DOM</h2>
        <button class="btn" onclick="checkDOMElement()">Verificar Elemento</button>
        <div id="domStatus"></div>
    </div>

    <div class="debug-section">
        <h2>üìà Cards de Progresso</h2>
        <div class="progress-grid" id="dashboardProgressGrid">
            <!-- Cards ser√£o renderizados aqui -->
        </div>
    </div>

    <div class="debug-section">
        <h2>üìù Logs</h2>
        <button class="btn" onclick="clearLogs()">Limpar Logs</button>
        <div id="logs"></div>
    </div>

    <!-- Scripts necess√°rios -->
    <script src="session-manager.js"></script>
    <script src="api-config.js"></script>
    <script src="chatgpt-api.js"></script>
    <script src="supabase-config.js"></script>
    <script src="sync-categories-supabase.js"></script>
    <script src="dashboard-progress-supabase-sync.js"></script>
    <script src="add-test-data.js"></script>

    <script>
        function addLog(message, type = 'info') {
            const logsDiv = document.getElementById('logs');
            const logDiv = document.createElement('div');
            logDiv.className = `log ${type}`;
            logDiv.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logsDiv.appendChild(logDiv);
            console.log(message);
        }

        function clearLogs() {
            document.getElementById('logs').innerHTML = '';
        }

        function checkScripts() {
            const statusDiv = document.getElementById('scriptStatus');
            statusDiv.innerHTML = '';
            
            const scripts = [
                'session-manager.js',
                'api-config.js',
                'chatgpt-api.js',
                'supabase-config.js',
                'sync-categories-supabase.js',
                'dashboard-progress-supabase-sync.js'
            ];

            scripts.forEach(script => {
                const div = document.createElement('div');
                div.className = 'log';
                div.textContent = `‚úÖ ${script} carregado`;
                statusDiv.appendChild(div);
            });

            // Verificar objetos globais
            const globalObjects = [
                { name: 'sessionManager', obj: window.sessionManager },
                { name: 'supabaseManager', obj: window.supabaseManager },
                { name: 'dashboardProgressSync', obj: window.dashboardProgressSync }
            ];

            globalObjects.forEach(({ name, obj }) => {
                const div = document.createElement('div');
                div.className = obj ? 'log success' : 'log error';
                div.textContent = `${obj ? '‚úÖ' : '‚ùå'} ${name}: ${obj ? 'dispon√≠vel' : 'n√£o encontrado'}`;
                statusDiv.appendChild(div);
            });
        }

        function initializeProgressSync() {
            const statusDiv = document.getElementById('initializationStatus');
            statusDiv.innerHTML = '';
            
            addLog('üîÑ Iniciando inicializa√ß√£o manual do ProgressSync...');
            
            if (window.dashboardProgressSync) {
                window.dashboardProgressSync.initialize().then(() => {
                    addLog('‚úÖ ProgressSync inicializado com sucesso', 'success');
                    statusDiv.innerHTML = '<div class="log success">‚úÖ ProgressSync inicializado com sucesso</div>';
                }).catch(error => {
                    addLog(`‚ùå Erro ao inicializar ProgressSync: ${error.message}`, 'error');
                    statusDiv.innerHTML = `<div class="log error">‚ùå Erro: ${error.message}</div>`;
                });
            } else {
                addLog('‚ùå dashboardProgressSync n√£o encontrado', 'error');
                statusDiv.innerHTML = '<div class="log error">‚ùå dashboardProgressSync n√£o encontrado</div>';
            }
        }

        function forceSync() {
            addLog('üîÑ For√ßando sincroniza√ß√£o...');
            
            if (window.dashboardProgressSync) {
                window.dashboardProgressSync.forceSync();
                addLog('‚úÖ Sincroniza√ß√£o for√ßada executada', 'success');
            } else {
                addLog('‚ùå dashboardProgressSync n√£o encontrado', 'error');
            }
        }

        function checkLocalStorage() {
            const statusDiv = document.getElementById('localStorageStatus');
            statusDiv.innerHTML = '';
            
            const keys = [
                'categories',
                'meditations',
                'personalized_meditations',
                'user_meditation_stats',
                'userData'
            ];

            keys.forEach(key => {
                const value = localStorage.getItem(key);
                const div = document.createElement('div');
                div.className = 'log';
                
                if (value) {
                    try {
                        const parsed = JSON.parse(value);
                        const count = Array.isArray(parsed) ? parsed.length : Object.keys(parsed).length;
                        div.textContent = `‚úÖ ${key}: ${count} itens`;
                    } catch (e) {
                        div.textContent = `‚ö†Ô∏è ${key}: valor n√£o √© JSON v√°lido`;
                        div.className = 'log error';
                    }
                } else {
                    div.textContent = `‚ùå ${key}: n√£o encontrado`;
                    div.className = 'log error';
                }
                
                statusDiv.appendChild(div);
            });
        }

        function checkDOMElement() {
            const statusDiv = document.getElementById('domStatus');
            statusDiv.innerHTML = '';
            
            const element = document.getElementById('dashboardProgressGrid');
            const div = document.createElement('div');
            
            if (element) {
                div.className = 'log success';
                div.textContent = `‚úÖ Elemento dashboardProgressGrid encontrado`;
            } else {
                div.className = 'log error';
                div.textContent = `‚ùå Elemento dashboardProgressGrid n√£o encontrado`;
            }
            
            statusDiv.appendChild(div);
        }

        // Inicializa√ß√£o autom√°tica
        document.addEventListener('DOMContentLoaded', function() {
            addLog('üöÄ P√°gina de debug carregada');
            checkScripts();
            checkDOMElement();
        });
    </script>
</body>
</html> 