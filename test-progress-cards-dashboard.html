<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Cards de Progresso Espiritual no Dashboard</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0d1117;
            color: #c9d1d9;
            margin: 0;
            padding: 2rem;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .btn {
            background: #238636;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            margin: 0.5rem;
            font-size: 0.9rem;
        }
        .btn:hover {
            background: #2ea043;
        }
        .btn-secondary {
            background: #21262d;
            border: 1px solid #30363d;
        }
        .btn-secondary:hover {
            background: #30363d;
        }
        .dashboard-simulation {
            background: #161b22;
            border: 1px solid #30363d;
            border-radius: 12px;
            padding: 2rem;
            margin: 1rem 0;
        }
        .progress-section {
            background: #21262d;
            border-radius: 8px;
            padding: 1.5rem;
            border: 1px solid #30363d;
        }
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #c9d1d9;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .progress-stats-row {
            display: flex;
            gap: 2rem;
            align-items: center;
            justify-content: flex-start;
            margin-bottom: 1.5rem;
        }
        .progress-stat-item {
            color: #8b949e;
            font-size: 0.9rem;
        }
        .progress-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        .progress-card {
            background: #161b22;
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid #30363d;
            transition: all 0.3s ease;
        }
        .progress-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }
        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .progress-title {
            font-weight: 600;
            color: #c9d1d9;
            font-size: 1.1rem;
        }
        .progress-percentage {
            font-weight: 700;
            color: #7ee787;
            font-size: 1.2rem;
        }
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #21262d;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #7ee787 0%, #56d364 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }
        .progress-text {
            color: #8b949e;
            font-size: 0.875rem;
        }
        .view-more-card {
            background: linear-gradient(135deg, #161b22 0%, #21262d 100%);
            border: 2px dashed #30363d;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .view-more-card:hover {
            border-color: #58a6ff;
            background: linear-gradient(135deg, #21262d 0%, #161b22 100%);
            transform: translateY(-3px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
        }
        .view-more-card .progress-title {
            color: #58a6ff;
        }
        .view-more-card .progress-percentage {
            color: #58a6ff !important;
        }
        .view-more-card .progress-text {
            color: #58a6ff !important;
        }
        .status {
            padding: 0.5rem;
            border-radius: 4px;
            margin: 0.5rem 0;
            font-size: 0.9rem;
        }
        .status.success {
            background: #0c2d6b;
            color: #58a6ff;
            border: 1px solid #1f6feb;
        }
        .status.error {
            background: #da3633;
            color: #ff7b72;
            border: 1px solid #f85149;
        }
        .status.info {
            background: #1c1f23;
            color: #8b949e;
            border: 1px solid #30363d;
        }
        .log {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 4px;
            padding: 1rem;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 0.8rem;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
        .test-result {
            background: #21262d;
            border: 1px solid #30363d;
            border-radius: 4px;
            padding: 1rem;
            margin: 0.5rem 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Teste - Cards de Progresso Espiritual no Dashboard</h1>
        
        <div class="test-section">
            <h3>üìä Status do Sistema</h3>
            <div id="systemStatus"></div>
        </div>

        <div class="test-section">
            <h3>üîß Controles de Teste</h3>
            <button class="btn" onclick="createTestData()">üìù Criar Dados de Teste</button>
            <button class="btn btn-secondary" onclick="clearTestData()">üóëÔ∏è Limpar Dados</button>
            <button class="btn" onclick="loadAndRender()">üîÑ Carregar e Renderizar</button>
            <button class="btn btn-secondary" onclick="testProgressCards()">üß™ Testar Cards</button>
            <button class="btn btn-secondary" onclick="clearLog()">üìã Limpar Log</button>
            <a href="dashboard.html" class="btn btn-secondary">üìä Ir para Dashboard</a>
        </div>

        <div class="test-section">
            <h3>üìä Simula√ß√£o do Dashboard - Se√ß√£o Progresso Espiritual</h3>
            <div class="dashboard-simulation">
                <div class="progress-section">
                    <h3 class="section-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M22 12h-4l-3 9L9 3l-3 9H2"/>
                        </svg>
                        Seu Progresso Espiritual
                    </h3>
                    <div class="progress-stats-row">
                        <div class="progress-stat-item"><strong>Total:</strong> <span id="statTotal">0</span></div>
                        <div class="progress-stat-item"><strong>Conclu√≠das:</strong> <span id="statCompleted">0</span></div>
                        <div class="progress-stat-item"><strong>Andamento:</strong> <span id="statInProgress">0</span></div>
                    </div>
                    <div class="progress-grid" id="dashboardProgressGrid">
                        <!-- Os cards de progresso por categoria ser√£o carregados dinamicamente -->
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>üìã Log de Opera√ß√µes</h3>
            <div id="logOutput" class="log"></div>
        </div>

        <div class="test-section">
            <h3>‚úÖ Resultados dos Testes</h3>
            <div id="testResults"></div>
        </div>
    </div>

    <script>
        let logOutput = [];
        let testResults = [];

        // Fun√ß√£o para adicionar log
        function addLog(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}`;
            logOutput.push(logEntry);
            
            const logElement = document.getElementById('logOutput');
            if (logElement) {
                logElement.textContent = logOutput.join('\n');
                logElement.scrollTop = logElement.scrollHeight;
            }
            
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        // Fun√ß√£o para adicionar resultado de teste
        function addTestResult(testName, success, details = '') {
            const result = {
                name: testName,
                success: success,
                details: details,
                timestamp: new Date().toLocaleTimeString()
            };
            testResults.push(result);
            updateTestResultsDisplay();
        }

        // Atualizar exibi√ß√£o dos resultados
        function updateTestResultsDisplay() {
            const resultsDiv = document.getElementById('testResults');
            if (!resultsDiv) return;

            const resultsHTML = testResults.map(result => `
                <div class="test-result">
                    <div class="status ${result.success ? 'success' : 'error'}">
                        ${result.success ? '‚úÖ' : '‚ùå'} ${result.name}
                    </div>
                    <div style="font-size: 0.8rem; color: #8b949e; margin-top: 0.5rem;">
                        ${result.details} (${result.timestamp})
                    </div>
                </div>
            `).join('');

            resultsDiv.innerHTML = resultsHTML;
        }

        // Verificar status do sistema
        function checkSystemStatus() {
            const statusDiv = document.getElementById('systemStatus');
            const sessionManager = window.sessionManager;
            const currentUser = sessionManager ? sessionManager.getCurrentUser() : null;
            
            let statusHTML = '';
            statusHTML += `<div class="status ${sessionManager ? 'success' : 'error'}">`;
            statusHTML += `${sessionManager ? '‚úÖ' : '‚ùå'} SessionManager: ${sessionManager ? 'Dispon√≠vel' : 'N√£o encontrado'}`;
            statusHTML += '</div>';
            
            if (currentUser) {
                statusHTML += `<div class="status success">`;
                statusHTML += `üë§ Usu√°rio: ${currentUser.name} (ID: ${currentUser.id})`;
                statusHTML += '</div>';
            } else {
                statusHTML += `<div class="status info">`;
                statusHTML += `üë§ Usu√°rio: Nenhum usu√°rio logado`;
                statusHTML += '</div>';
            }
            
            statusDiv.innerHTML = statusHTML;
        }

        // Criar dados de teste
        function createTestData() {
            addLog('üìù Criando dados de teste para progresso espiritual...');
            
            // Criar categorias de teste
            const testCategories = [
                {
                    id: 'cat_test_1',
                    name: 'Salmos',
                    description: 'Medita√ß√µes baseadas nos Salmos',
                    icon: 'üìñ',
                    color: '#7ee787'
                },
                {
                    id: 'cat_test_2',
                    name: 'Evangelho',
                    description: 'Medita√ß√µes dos Evangelhos',
                    icon: '‚úùÔ∏è',
                    color: '#58a6ff'
                },
                {
                    id: 'cat_test_3',
                    name: 'Imita√ß√£o de Cristo',
                    description: 'Medita√ß√µes da Imita√ß√£o de Cristo',
                    icon: 'üïäÔ∏è',
                    color: '#8b5cf6'
                },
                {
                    id: 'cat_test_4',
                    name: 'Jaculat√≥rias',
                    description: 'Ora√ß√µes curtas e fervorosas',
                    icon: 'üôè',
                    color: '#f59e0b'
                },
                {
                    id: 'cat_test_5',
                    name: 'Princ√≠pios Espirituais',
                    description: 'Fundamentos da vida espiritual',
                    icon: '‚≠ê',
                    color: '#ec4899'
                }
            ];

            // Criar medita√ß√µes de teste
            const testMeditations = [
                // Salmos
                { id: 'med_1', categoryId: 'cat_test_1', title: 'Salmo 23', status: 'completed' },
                { id: 'med_2', categoryId: 'cat_test_1', title: 'Salmo 51', status: 'completed' },
                { id: 'med_3', categoryId: 'cat_test_1', title: 'Salmo 91', status: 'in_progress' },
                { id: 'med_4', categoryId: 'cat_test_1', title: 'Salmo 139', status: 'pending' },
                { id: 'med_5', categoryId: 'cat_test_1', title: 'Salmo 150', status: 'pending' },
                
                // Evangelho
                { id: 'med_6', categoryId: 'cat_test_2', title: 'Jo√£o 3:16', status: 'completed' },
                { id: 'med_7', categoryId: 'cat_test_2', title: 'Mateus 5-7', status: 'in_progress' },
                { id: 'med_8', categoryId: 'cat_test_2', title: 'Lucas 15', status: 'pending' },
                { id: 'med_9', categoryId: 'cat_test_2', title: 'Marcos 4', status: 'pending' },
                
                // Imita√ß√£o de Cristo
                { id: 'med_10', categoryId: 'cat_test_3', title: 'Livro I, Cap. 1', status: 'completed' },
                { id: 'med_11', categoryId: 'cat_test_3', title: 'Livro I, Cap. 2', status: 'completed' },
                { id: 'med_12', categoryId: 'cat_test_3', title: 'Livro I, Cap. 3', status: 'pending' },
                { id: 'med_13', categoryId: 'cat_test_3', title: 'Livro II, Cap. 1', status: 'pending' },
                
                // Jaculat√≥rias
                { id: 'med_14', categoryId: 'cat_test_4', title: 'Jesus, eu confio em V√≥s', status: 'completed' },
                { id: 'med_15', categoryId: 'cat_test_4', title: 'Ave Maria', status: 'completed' },
                { id: 'med_16', categoryId: 'cat_test_4', title: 'Pai Nosso', status: 'completed' },
                
                // Princ√≠pios Espirituais
                { id: 'med_17', categoryId: 'cat_test_5', title: 'Humildade', status: 'in_progress' },
                { id: 'med_18', categoryId: 'cat_test_5', title: 'Ora√ß√£o', status: 'pending' },
                { id: 'med_19', categoryId: 'cat_test_5', title: 'Caridade', status: 'pending' },
                { id: 'med_20', categoryId: 'cat_test_5', title: 'Paci√™ncia', status: 'pending' }
            ];

            // Criar medita√ß√µes personalizadas
            const testPersonalized = [
                {
                    id: 'pers_1',
                    title: 'Medita√ß√£o Personalizada 1',
                    topic: 'Medita√ß√µes Personalizadas',
                    status: 'completed',
                    userId: 'test_user',
                    userName: 'Usu√°rio Teste'
                },
                {
                    id: 'pers_2',
                    title: 'Medita√ß√£o Personalizada 2',
                    topic: 'Medita√ß√µes Personalizadas',
                    status: 'in_progress',
                    userId: 'test_user',
                    userName: 'Usu√°rio Teste'
                },
                {
                    id: 'pers_3',
                    title: 'Medita√ß√£o Personalizada 3',
                    topic: 'Reflex√µes Di√°rias',
                    status: 'completed',
                    userId: 'test_user',
                    userName: 'Usu√°rio Teste'
                }
            ];

            localStorage.setItem('categories', JSON.stringify(testCategories));
            localStorage.setItem('meditations', JSON.stringify(testMeditations));
            localStorage.setItem('personalized_meditations', JSON.stringify(testPersonalized));
            
            addLog(`‚úÖ ${testCategories.length} categorias criadas`);
            addLog(`‚úÖ ${testMeditations.length} medita√ß√µes criadas`);
            addLog(`‚úÖ ${testPersonalized.length} medita√ß√µes personalizadas criadas`);
            addTestResult('Cria√ß√£o de Dados', true, `${testCategories.length} categorias, ${testMeditations.length} medita√ß√µes, ${testPersonalized.length} personalizadas`);
            
            loadAndRender();
        }

        // Limpar dados de teste
        function clearTestData() {
            localStorage.removeItem('categories');
            localStorage.removeItem('meditations');
            localStorage.removeItem('personalized_meditations');
            addLog('üóëÔ∏è Dados de teste removidos');
            addTestResult('Limpeza de Dados', true, 'Dados removidos com sucesso');
            loadAndRender();
        }

        // Carregar e renderizar
        function loadAndRender() {
            addLog('üîÑ Carregando e renderizando cards de progresso...');
            
            if (window.renderDashboardProgressCards) {
                addLog('‚úÖ Fun√ß√£o renderDashboardProgressCards encontrada');
                window.renderDashboardProgressCards();
                addTestResult('Renderiza√ß√£o', true, 'Cards renderizados usando fun√ß√£o espec√≠fica');
            } else {
                addLog('‚ö†Ô∏è Fun√ß√£o renderDashboardProgressCards n√£o encontrada');
                addTestResult('Renderiza√ß√£o', false, 'Fun√ß√£o espec√≠fica n√£o encontrada');
            }
        }

        // Testar cards de progresso
        function testProgressCards() {
            addLog('üß™ Testando cards de progresso espiritual...');
            
            const progressGrid = document.getElementById('dashboardProgressGrid');
            if (!progressGrid) {
                addLog('‚ùå Elemento dashboardProgressGrid n√£o encontrado', 'error');
                addTestResult('Elemento DOM', false, 'dashboardProgressGrid n√£o encontrado');
                return;
            }
            
            const cards = progressGrid.querySelectorAll('.progress-card');
            addLog(`üìä Encontrados ${cards.length} cards de progresso`);
            
            if (cards.length > 0) {
                addLog('‚úÖ Cards de progresso renderizados com sucesso');
                addTestResult('Renderiza√ß√£o de Cards', true, `${cards.length} cards exibidos`);
                
                // Verificar se h√° mais de 3 categorias e se o card "Ver mais" foi adicionado
                const viewMoreCard = progressGrid.querySelector('.view-more-card');
                if (viewMoreCard) {
                    addLog('‚úÖ Card "Ver mais" encontrado');
                    addTestResult('Card Ver Mais', true, 'Card adicional para categorias extras');
                } else {
                    addLog('‚ÑπÔ∏è Card "Ver mais" n√£o necess√°rio (3 ou menos categorias)');
                }
            } else {
                addLog('‚ùå Nenhum card de progresso encontrado', 'error');
                addTestResult('Renderiza√ß√£o de Cards', false, 'Nenhum card foi renderizado');
            }
        }

        // Limpar log
        function clearLog() {
            logOutput = [];
            testResults = [];
            document.getElementById('logOutput').textContent = '';
            updateTestResultsDisplay();
            addLog('üìã Log limpo');
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function() {
            addLog('üöÄ P√°gina de teste dos cards de progresso carregada');
            checkSystemStatus();
            loadAndRender();
        });
    </script>

    <!-- Incluir o script de cards de progresso -->
    <script src="dashboard-progress-cards.js"></script>
</body>
</html> 